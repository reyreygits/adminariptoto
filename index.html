<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Admin Panel - ARIPTOTO</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #0a0f1c;
    color: white;
    margin: 0;
    padding: 20px;
  }
  h1, h2 {
    color: #FFD700;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 25px;
  }
  th, td {
    padding: 10px;
    border: 1px solid #555;
    text-align: left;
  }
  th {
    background: #222a44;
  }
  tr:nth-child(even) {
    background: #1a1f33;
  }
  input, select, button {
    padding: 8px;
    margin: 5px 0 15px 0;
    border-radius: 5px;
    border: none;
    outline: none;
    font-size: 16px;
  }
  input[type=text], input[type=password], input[type=number] {
    width: 100%;
    box-sizing: border-box;
  }
  button {
    background: #00cc66;
    color: white;
    cursor: pointer;
    font-weight: bold;
    transition: 0.3s;
  }
  button:hover {
    background: #00994d;
  }
  .form-section {
    background: #111a33;
    padding: 20px;
    border-radius: 10px;
    max-width: 400px;
    margin-bottom: 30px;
  }
  .flex-row {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }
  .flex-row > * {
    flex: 1 1 48%;
  }
</style>
</head>
<body>

<h1>Admin Panel - ARIPTOTO</h1>

<section>
  <h2>Daftar User</h2>
  <table id="userTable">
    <thead>
      <tr>
        <th>User ID</th>
        <th>Bank</th>
        <th>No Rekening</th>
        <th>Nama Rekening</th>
        <th>No HP</th>
        <th>Saldo (Rp)</th>
      </tr>
    </thead>
    <tbody>
      <!-- Data user akan muncul di sini -->
    </tbody>
  </table>
</section>

<section class="form-section">
  <h2>Reset Password</h2>
  <label for="resetUser">Pilih User ID:</label>
  <select id="resetUser"></select>

  <label for="newPassword">Password Baru:</label>
  <input type="password" id="newPassword" placeholder="Masukkan password baru" />

  <button onclick="resetPassword()">Reset Password</button>
</section>

<section class="form-section">
  <h2>Tambah Saldo</h2>
  <label for="saldoUser">Pilih User ID:</label>
  <select id="saldoUser"></select>

  <label for="saldoAmount">Jumlah Saldo (Rp):</label>
  <input type="number" id="saldoAmount" placeholder="Masukkan jumlah saldo" min="1" />

  <button onclick="addSaldo()">Tambah Saldo</button>
</section>

<section class="form-section">
  <h2>Hapus Saldo</h2>
  <label for="hapusSaldoUser">Pilih User ID:</label>
  <select id="hapusSaldoUser"></select>

  <button onclick="hapusSaldo()" style="background: #ff4444;">Hapus Saldo</button>
</section>

<script>
  // Ambil users dari localStorage
  function getUsers() {
    return JSON.parse(localStorage.getItem('users') || '{}');
  }

  // Simpan users ke localStorage
  function setUsers(users) {
    localStorage.setItem('users', JSON.stringify(users));
  }

  // Tampilkan data user di tabel
  function displayUsers() {
    const users = getUsers();
    const tbody = document.querySelector('#userTable tbody');
    tbody.innerHTML = '';

    for (const user in users) {
      const u = users[user];
      const saldo = u.balance || 0;
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${user}</td>
        <td>${u.bank}</td>
        <td>${u.rekNum}</td>
        <td>${u.rekName}</td>
        <td>${u.phone}</td>
        <td style="text-align:right">${saldo.toLocaleString('id-ID')}</td>
      `;
      tbody.appendChild(tr);
    }
  }

  // Isi dropdown untuk reset password, tambah saldo, dan hapus saldo
  function fillUserSelects() {
    const users = getUsers();
    const resetUserSelect = document.getElementById('resetUser');
    const saldoUserSelect = document.getElementById('saldoUser');
    const hapusSaldoUserSelect = document.getElementById('hapusSaldoUser');

    resetUserSelect.innerHTML = '';
    saldoUserSelect.innerHTML = '';
    hapusSaldoUserSelect.innerHTML = '';

    for (const user in users) {
      const option1 = document.createElement('option');
      option1.value = user;
      option1.textContent = user;
      resetUserSelect.appendChild(option1);

      const option2 = document.createElement('option');
      option2.value = user;
      option2.textContent = user;
      saldoUserSelect.appendChild(option2);

      const option3 = document.createElement('option');
      option3.value = user;
      option3.textContent = user;
      hapusSaldoUserSelect.appendChild(option3);
    }
  }

  // Reset password fungsi
  function resetPassword() {
    const user = document.getElementById('resetUser').value;
    const newPass = document.getElementById('newPassword').value.trim();

    if (!user) {
      alert('Pilih User terlebih dahulu.');
      return;
    }
    if (newPass.length < 4) {
      alert('Password harus minimal 4 karakter.');
      return;
    }

    const users = getUsers();
    if (!users[user]) {
      alert('User tidak ditemukan.');
      return;
    }

    users[user].pass = newPass;
    setUsers(users);

    alert(`Password untuk user "${user}" berhasil di-reset.`);
    document.getElementById('newPassword').value = '';
  }

  // Tambah saldo fungsi
  function addSaldo() {
    const user = document.getElementById('saldoUser').value;
    const amount = parseInt(document.getElementById('saldoAmount').value, 10);

    if (!user) {
      alert('Pilih User terlebih dahulu.');
      return;
    }
    if (isNaN(amount) || amount <= 0) {
      alert('Masukkan jumlah saldo yang valid.');
      return;
    }

    const users = getUsers();
    if (!users[user]) {
      alert('User tidak ditemukan.');
      return;
    }

    users[user].balance = (users[user].balance || 0) + amount;
    setUsers(users);

    alert(`Saldo Rp ${amount.toLocaleString('id-ID')} berhasil ditambahkan ke user "${user}".`);
    document.getElementById('saldoAmount').value = '';

    displayUsers();
  }

  // Hapus saldo fungsi
  function hapusSaldo() {
    const user = document.getElementById('hapusSaldoUser').value;

    if (!user) {
      alert('Pilih User terlebih dahulu.');
      return;
    }

    const confirmed = confirm(`Yakin ingin menghapus saldo user "${user}"?`);
    if (!confirmed) return;

    const users = getUsers();
    if (!users[user]) {
      alert('User tidak ditemukan.');
      return;
    }

    users[user].balance = 0;
    setUsers(users);

    alert(`Saldo user "${user}" berhasil dihapus.`);
    displayUsers();
  }

  // Inisialisasi halaman admin
  function initAdmin() {
    displayUsers();
    fillUserSelects();
  }

  // Jalankan saat halaman load
  window.onload = initAdmin;
</script>

</body>
</html>
