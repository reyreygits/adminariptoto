<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ARIPTOTO - Admin Panel</title>
  <style>
    /* Gaya CSS untuk halaman admin */
    body { font-family: Arial, sans-serif; }
    .container { max-width: 800px; margin: 20px auto; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px; text-align: left; border: 1px solid #ddd; }
    button { padding: 10px 20px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
    button:hover { background-color: #45a049; }
    .form-box { background: #f2f2f2; padding: 20px; margin: 20px 0; }
  </style>
</head>
<body>

  <header>
    <div class="logo">ARIPTOTO - Admin Panel</div>
    <div class="menu">
      <a href="admin.html">Admin</a>
      <a href="#" onclick="logout()">Logout</a>
    </div>
  </header>

  <div class="container">
    <h2>Daftar Pengguna Terdaftar</h2>
    <table class="table" id="userTable">
      <thead>
        <tr>
          <th>User ID</th>
          <th>Saldo</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <!-- Data Pengguna akan muncul disini -->
      </tbody>
    </table>

    <div class="form-box">
      <h3>Tambah Saldo</h3>
      <input type="text" id="userIDToAdd" placeholder="User ID" />
      <input type="number" id="addSaldo" placeholder="Jumlah Saldo" />
      <button onclick="addSaldo()">Tambah Saldo</button>
    </div>
  </div>

  <script>
    // Memuat dan menampilkan data pengguna dari localStorage
    function loadUsers() {
      let users = JSON.parse(localStorage.getItem('users') || '{}');
      const userTable = document.getElementById('userTable').getElementsByTagName('tbody')[0];
      userTable.innerHTML = '';  // Clear previous rows

      for (let userID in users) {
        let user = users[userID];
        let row = userTable.insertRow();
        row.insertCell(0).innerText = userID;
        row.insertCell(1).innerText = `Rp ${user.balance}`;
        row.insertCell(2).innerHTML = `<button onclick="showAddSaldoForm('${userID}')">Tambah Saldo</button>`;
      }
    }

    // Fungsi menampilkan form tambah saldo
    function showAddSaldoForm(userID) {
      document.getElementById('userIDToAdd').value = userID;
      document.getElementById('addSaldo').focus();
    }

    // Fungsi untuk menambah saldo
    function addSaldo() {
      let userID = document.getElementById('userIDToAdd').value.trim();
      let saldoToAdd = parseFloat(document.getElementById('addSaldo').value.trim());

      if (!userID || isNaN(saldoToAdd) || saldoToAdd <= 0) {
        alert('Harap masukkan ID pengguna yang valid dan jumlah saldo yang benar.');
        return;
      }

      let users = JSON.parse(localStorage.getItem('users') || '{}');
      if (!users[userID]) {
        alert('Pengguna tidak ditemukan.');
        return;
      }

      users[userID].balance += saldoToAdd;
      localStorage.setItem('users', JSON.stringify(users));
      loadUsers();
      alert(`Saldo berhasil ditambahkan ke akun ${userID}.`);
    }

    // Fungsi Logout
    function logout() {
      window.location.href = 'index.html';  // Redirect ke halaman login
    }

    window.onload = loadUsers;  // Memanggil fungsi loadUsers saat halaman di-load
  </script>

</body>
</html>
